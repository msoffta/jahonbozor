enum PaymentType {
    CASH
    CREDIT_CARD
}

enum OrderStatus {
    NEW
    ACCEPTED
    CANCELLED
}

model Order {
    id          Int         @id @default(autoincrement())
    userId      Int?
    staffId     Int?
    items       OrderItem[]
    paymentType PaymentType
    status      OrderStatus @default(NEW)
    data        Json

    user  Users? @relation(fields: [userId], references: [id], onDelete: SetNull)
    staff Staff? @relation(fields: [staffId], references: [id], onDelete: SetNull)

    createdAt DateTime @default(now())
    updatedAt DateTime @updatedAt

    @@index([userId])
    @@index([staffId])
    @@index([status])
}

model OrderItem {
    id        Int     @id @default(autoincrement())
    orderId   Int
    productId Int
    quantity  Int
    price     Decimal @db.Decimal(10, 2)
    data      Json?

    order   Order   @relation(fields: [orderId], references: [id])
    product Product @relation(fields: [productId], references: [id])

    createdAt DateTime @default(now())
    updatedAt DateTime @updatedAt

    @@index([orderId])
    @@index([productId])
}
